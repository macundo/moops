cmake_minimum_required(VERSION 2.8)

project(MOOPS)

SET(APP_LIBS "" CACHE INTERNAL "")
SET(USE_CUDA_FLUID_SOLVER OFF CACHE BOOL "Use the cuda-based Stokes solver.")
SET(USE_QT_GUI OFF CACHE BOOL "Build the QT4 GUI framework.")

#FindVTK
FIND_PACKAGE(VTK REQUIRED)
INCLUDE(${VTK_USE_FILE})
SET(APP_LIBS ${APP_LIBS} vtkIO)

# FindQt4
if(USE_QT_GUI)
    FIND_PACKAGE(Qt4 REQUIRED)
    SET(QT_USE_QTOPENGL TRUE)
    INCLUDE(${QT_USE_FILE})
    ADD_DEFINITIONS(${QT_DEFINITIONS} -DUSE_QT_GUI)
    SET(APP_LIBS ${APP_LIBS} gui QVTK vtkRendering vtkGraphics vtkCommon)
    ADD_SUBDIRECTORY(gui)
endif(USE_QT_GUI)


INCLUDE_DIRECTORIES(${PROJECT_SOURCE_DIR})
INCLUDE_DIRECTORIES(${PROJECT_SOURCE_DIR}/testing)

IF(USE_CUDA_FLUID_SOLVER)
  ADD_SUBDIRECTORY(math)
  ADD_DEFINITIONS(-DUSE_CUDA_FLUID_SOLVER)
  SET(APP_LIBS ${APP_LIBS} cudaStokesSolver)
ENDIF(USE_CUDA_FLUID_SOLVER)

INCLUDE(CTest)
IF(BUILD_TESTING)
    ENABLE_TESTING()
    ADD_SUBDIRECTORY(testing)
ENDIF(BUILD_TESTING)

ADD_SUBDIRECTORY(examples)

add_subdirectory(particle_system/testing)

add_subdirectory(math/testing)